
<header class="bg-danger text-white py-4">
  <div class="container">
    <h1 class="mb-0">FTView Demo Displays Translation!</h1>
  </div>
</header>

<div class="container my-4">
  <div class="language-panel">
    <div class="language-select">
      <!-- Source Language Dropdown -->    
      <label for="sourceLanguage" class="form-label">Source Language</label>
      <select class="form-select" id="sourceLanguage" name="sourceLanguage" [(ngModel)]="translateFilesData.sourceLanguage">
        <option value="English">English</option>
        <option value="Chinese">Chinese</option>
        <option value="French">French</option>
        <!-- Add more options as needed -->
      </select>    
    </div>
    <div class="language-select">
      <!-- Target Language Dropdown -->    
      <label for="targetLanguage" class="form-label">Target Language</label>
      <select class="form-select" id="targetLanguage" name="targetLanguage" [(ngModel)]="translateFilesData.targetLanguage">
        <option value="English">English</option>
        <option value="Chinese">Chinese</option>
        <option value="French">French</option>
        <!-- Add more options as needed -->
      </select>
    </div> 
  </div>

<div class="file-table">
  <div class="drop-zone" (dragover)="onDragOver($event)" (drop)="onDrop($event)">
    <p>Drag & drop files here or <span class="browse-link" (click)="browseFiles()">browse</span></p>
  </div>
  <input type="file" #fileInput style="display: none;" (change)="onFileSelected($event)" multiple>
   
  <table >
  <thead>
    <tr>
      <th>File Id</th>
      <th>File Name</th>
      <th>Size</th>
      <th>Status</th>
      <th>Progress</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let uploadedFile of uploadedFiles"> <!--use array for uploaded file, becasue we need to show them one by one-->
      <td>{{ uploadedFile.fileId }}</td>
      <td>{{ uploadedFile.fileName }}</td>
      <td>{{ uploadedFile.fileSize | fileSize}}</td>
      <td>
        <div [ngClass]="{ 
          'status-uploading': uploadedFile.status === 'Uploading', 
          'status-completed': uploadedFile.status === 'Completed', 
          'status-failed': uploadedFile.status === 'Failed' 
          }">
          {{ uploadedFile.status }}
        </div>
      </td>
      <td>  
        <!-- This div acts as the progress bar -->  
        <div class="progress-bar-container">  
          <div class="progress-bar" [ngStyle]="{'width': uploadedFile.progress + '%'}"></div>  
        </div>  
      </td>
      <td><button (click)="deleteFile(uploadedFile.fileId)">Delete</button></td>
    </tr>
  </tbody>
</table>
</div>
<div class="translate-button-container">
  <button class="translate-button" (click)="onTranslateRequest()">Translate Files</button>
  <span *ngIf="loading === true" class="spinner-border text-primary" role="status" aria-hidden="true" style="margin-left: 5px;"></span>
</div>

<!-- Using the getter method to convert dictionary to an array for display -->  
<div class="file-table">
  <table >
    <thead>
      <tr>
        <th>File Id</th>
        <th>File Name</th>
        <th>Actions</th>
        <th>Count TM</th>
        <th>Count MT</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let file of translatedFilesArray">
        <td>{{ file.fileId }}</td>
        <td>{{ file.translatedFile.fileName }}</td>
        <td>
          <!-- View -->
          <!-- Link to the comparison page --> 
           <!--          
          <a routerLink="/comparison">View Comparison</a>--> 
          <img src="assets/images/view.jfif" alt="View Image" (click)="viewFile(file.fileId)" class="cell-image bi bi-eye bi-sm text-primary icon-with-tooltip"
          data-bs-toggle="tooltip" data-bs-placement="top" title="View file">
          
          <!-- Download -->
          <img src="assets/images/download.jfif" alt="Download Image" (click)="downloadFile(file.fileId)" class="cell-image bi bi-eye bi-sm text-primary icon-with-tooltip"
          data-bs-toggle="tooltip" data-bs-placement="top" title="Download file">
          
        </td>
        <td>{{file.translatedFile.countTM}}</td>
        <td>{{file.translatedFile.countMT}}</td>
      </tr>
    </tbody>
  </table>
</div>

</div>
